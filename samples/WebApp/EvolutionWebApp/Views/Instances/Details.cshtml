@model Evolution.Client.CSharp.Models.Instance.InstanceResponse?

@{
    ViewData["Title"] = "Detalhes da Instância";
}

<div class="container mt-4">
    <div class="card">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h2>Detalhes da Instância: @Model?.Name</h2>
            <a asp-action="Index" class="btn btn-light">Voltar para Lista</a>
        </div>
        <div class="card-body">
            @if (Model != null)
            {
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <h4>Informações Básicas</h4>
                            <hr />
                            <dl class="row">
                                <dt class="col-sm-4">Nome:</dt>
                                <dd class="col-sm-8">@Model.Name</dd>

                                <dt class="col-sm-4">ID:</dt>
                                <dd class="col-sm-8">@Model.Id</dd>

                                <dt class="col-sm-4">Status:</dt>
                                <dd class="col-sm-8">
                                    <span class="badge @(Model.ConnectionStatus == "open" ? "bg-success" : "bg-danger")">
                                        @Model.ConnectionStatus
                                    </span>
                                </dd>

                                <dt class="col-sm-4">Integração:</dt>
                                <dd class="col-sm-8">@Model.Integration</dd>

                                <dt class="col-sm-4">Número:</dt>
                                <dd class="col-sm-8">@(Model.Number ?? "Não definido")</dd>

                                <dt class="col-sm-4">Token:</dt>
                                <dd class="col-sm-8">@Model.Token</dd>

                                <dt class="col-sm-4">Cliente:</dt>
                                <dd class="col-sm-8">@(Model.ClientName ?? "Não definido")</dd>

                                <dt class="col-sm-4">Criado em:</dt>
                                <dd class="col-sm-8">@Model.CreatedAt.ToString("dd/MM/yyyy HH:mm:ss")</dd>

                                <dt class="col-sm-4">Atualizado em:</dt>
                                <dd class="col-sm-8">@Model.UpdatedAt.ToString("dd/MM/yyyy HH:mm:ss")</dd>
                            </dl>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        @if (Model.DisconnectionReasonCode.HasValue || !string.IsNullOrEmpty(Model.DisconnectionObject?.ToString()) || Model.DisconnectionAt.HasValue)
                        {
                            <div class="mb-3">
                                <h4>Informações de Desconexão</h4>
                                <hr />
                                <dl class="row">
                                    @if (Model.DisconnectionReasonCode.HasValue)
                                    {
                                        <dt class="col-sm-4">Código:</dt>
                                        <dd class="col-sm-8">
                                            <span class="badge bg-warning">@Model.DisconnectionReasonCode</span>
                                        </dd>
                                    }

                                    @if (Model.DisconnectionAt.HasValue)
                                    {
                                        <dt class="col-sm-4">Data:</dt>
                                        <dd class="col-sm-8">@Model.DisconnectionAt.Value.ToString("dd/MM/yyyy HH:mm:ss")</dd>
                                    }

                                    @if (!string.IsNullOrEmpty(Model.DisconnectionObject?.ToString()))
                                    {
                                        <dt class="col-sm-12">Detalhes:</dt>
                                        <dd class="col-sm-12">
                                            <div class="alert alert-warning">
                                                <small>
                                                    <pre style="white-space: pre-wrap; word-break: break-all;">@Model.DisconnectionObject</pre>
                                                </small>
                                            </div>
                                        </dd>
                                    }
                                </dl>
                            </div>
                        }

                        @if (Model.Setting != null)
                        {
                            <div class="mb-3">
                                <h4>Configurações</h4>
                                <hr />
                                <dl class="row">
                                    <dt class="col-sm-6">Rejeitar Chamadas:</dt>
                                    <dd class="col-sm-6">
                                        <span class="badge @(Model.Setting.RejectCall ? "bg-danger" : "bg-success")">
                                            @(Model.Setting.RejectCall ? "Sim" : "Não")
                                        </span>
                                    </dd>

                                    <dt class="col-sm-6">Ignorar Grupos:</dt>
                                    <dd class="col-sm-6">
                                        <span class="badge @(Model.Setting.GroupsIgnore ? "bg-warning" : "bg-success")">
                                            @(Model.Setting.GroupsIgnore ? "Sim" : "Não")
                                        </span>
                                    </dd>

                                    <dt class="col-sm-6">Sempre Online:</dt>
                                    <dd class="col-sm-6">
                                        <span class="badge @(Model.Setting.AlwaysOnline ? "bg-success" : "bg-secondary")">
                                            @(Model.Setting.AlwaysOnline ? "Sim" : "Não")
                                        </span>
                                    </dd>

                                    <dt class="col-sm-6">Ler Mensagens:</dt>
                                    <dd class="col-sm-6">
                                        <span class="badge @(Model.Setting.ReadMessages ? "bg-success" : "bg-secondary")">
                                            @(Model.Setting.ReadMessages ? "Sim" : "Não")
                                        </span>
                                    </dd>

                                    <dt class="col-sm-6">Ler Status:</dt>
                                    <dd class="col-sm-6">
                                        <span class="badge @(Model.Setting.ReadStatus ? "bg-success" : "bg-secondary")">
                                            @(Model.Setting.ReadStatus ? "Sim" : "Não")
                                        </span>
                                    </dd>

                                    <dt class="col-sm-6">Sincronizar Histórico:</dt>
                                    <dd class="col-sm-6">
                                        <span class="badge @(Model.Setting.SyncFullHistory ? "bg-info" : "bg-secondary")">
                                            @(Model.Setting.SyncFullHistory ? "Sim" : "Não")
                                        </span>
                                    </dd>
                                </dl>
                            </div>
                        }

                        @if (Model.Count != null)
                        {
                            <div class="mb-3">
                                <h4>Estatísticas</h4>
                                <hr />
                                <dl class="row">
                                    <dt class="col-sm-4">Mensagens:</dt>
                                    <dd class="col-sm-8"><span class="badge bg-primary">@Model.Count.Message</span></dd>

                                    <dt class="col-sm-4">Contatos:</dt>
                                    <dd class="col-sm-8"><span class="badge bg-info">@Model.Count.Contact</span></dd>

                                    <dt class="col-sm-4">Chats:</dt>
                                    <dd class="col-sm-8"><span class="badge bg-success">@Model.Count.Chat</span></dd>
                                </dl>
                            </div>
                        }
                    </div>
                </div>
            }
            else
            {
                <div class="alert alert-warning" role="alert">
                    <h4 class="alert-heading">Dados incompletos!</h4>
                    <p>Não foi possível obter os detalhes completos desta instância.</p>
                </div>
            }
        </div>
    </div>
</div>
